Напиши программу на Python для шифрования и расшифрования текста с помощью шифра Цезаря, соответствующую следующим требованиям:

**Цель:** Программа должна работать с русским литературным текстом, сохраняя пробелы, знаки препинания и регистр букв.

**Требования:**

1. **Алфавит:** Использовать русский алфавит из 32 букв (без Ё), в порядке: 
   "АБВГДЕЖЗИЙКЛМНОПРСТУФХЦЧШЩЪЫЬЭЮЯ"

2. **Ключ (сдвиг):** Пользователь задаёт целое число k (ключ). 
   - Для шифрования: каждая буква сдвигается на k позиций вперёд.
   - Для расшифрования: каждая буква сдвигается на k позиций назад.

3. **Формула шифрования:**
   - Шифрование: Y_i = X_{(i + k) mod 32}
   - Расшифрование: X_i = Y_{(i - k + 32) mod 32}
   Где i — номер буквы в алфавите (от 1 до 32).

4. **Особенности обработки текста:**
   - Желательно сохранять регистр: если буква была заглавной, результат тоже заглавный.
   - Неалфавитные символы (пробелы, знаки препинания, цифры) меняются так как написано в файле требований ко всем лабам (создается расширенный алфавит как в шифровании Атбаш (соседний файл))

5. **Функциональность программы:**
   - Режим работы: шифрование или расшифрование (выбор через меню или аргумент).
   - Ввод текста: из файла или из консоли (на выбор).
   - Вывод результата: в файл или на экран.

6. **Интерфейс:** Консольный, простой и понятный.

**Пример данных для проверки (из методички):**
- Алфавит: 32 буквы как выше.
- Ключ по умолчанию в методичке: k = 3.
- Тестовый пример: "АБВ" → "ГДЕ", "Я" → "В".

**Ожидаемый результат:**
Программа на Python, содержащая:
1. Функцию для создания алфавита и сопоставления букв с индексами.
2. Функцию сдвига одной буквы с учётом регистра.
3. Функцию обработки всего текста.
4. Основной блок с вводом/выводом и меню выбора режима.
5. Комментарии на русском языке для понимания логики.

**Дополнительно (если возможно):**
- Добавить обработку ошибок (неверный ключ, пустой текст и т.д.).

Пожалуйста, предоставь полный код с пояснениями.